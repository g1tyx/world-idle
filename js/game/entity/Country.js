define(["calculator/PriceCalculator"],function(t){var e=function(t,e){this.meta=t,this.level=e,this.tiles=t.tiles[(e-1)%t.tiles.length],this.baseSoldiers=new BigNumber(0),this.subSoldiers=new BigNumber(0),this.soldiers=new BigNumber(0),this.tilesConquered=0,this.conquered=!1,this.production=new BigNumber(0),this.productionResourceId=null}
return e.prototype.setup=function(){var e=new t(this.meta.soldiers,this.meta.soldiersIncrease)
this.baseSoldiers=e.getPrice(this.level-1,1),this.subSoldiers=new BigNumber(0),this.soldiers=new BigNumber(0),this.tilesConquered=0,this.conquered=!1,this.calculateSub(),this.calculateProduction()},e.prototype.calculateSub=function(){var e=new t(this.baseSoldiers,this.meta.subIncrease)
this.subSoldiers=e.getPrice(this.tilesConquered,1),this.soldiers=this.subSoldiers},e.prototype.calculateProduction=function(){this.productionResourceId=this.meta.productionOrder[(this.level-1)%this.meta.productionOrder.length]
var e=new t(this.meta.production[this.productionResourceId],this.meta.productionIncrease)
this.production=e.getPrice(this.level-1,1)},e.prototype.addTileConquered=function(){this.tilesConquered++,this.tilesConquered>=this.tiles?this.conquered=!0:this.calculateSub()},e.prototype.getMeta=function(){return this.meta},e.prototype.getProduction=function(){return this.production},e.prototype.getProductionResourceId=function(){return this.productionResourceId},e.prototype.getAttack=function(){return this.soldiers.multiply(this.meta.strength)},e.prototype.getSoldiers=function(){return this.soldiers},e.prototype.getMaxSoldiers=function(){return this.subSoldiers},e.prototype.subtractSoldiers=function(t){this.soldiers=this.soldiers.subtract(t)},e.prototype.setSoldiers=function(t){this.soldiers=t},e.prototype.getIsConquered=function(){return this.conquered},e.prototype.getTiles=function(){return this.tiles},e.prototype.getTilesConquered=function(){return this.tilesConquered},e.prototype.getLevel=function(){return this.level},e.prototype.getSaveData=function(){return[this.level,this.soldiers.toString(),this.tilesConquered,this.conquered]},e.prototype.updateFromSaveData=function(t){this.level=t[0],this.soldiers=new BigNumber(t[1]),this.soldiers.compare(this.subSoldiers)>=1&&(this.soldiers=this.subSoldiers),this.tilesConquered=t[2],this.conquered=t[3],this.calculateProduction()},e})
